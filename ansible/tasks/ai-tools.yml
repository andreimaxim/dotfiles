---
- name: Check if Claude Code is installed
  stat:
    path: "{{ ansible_env.HOME }}/.local/bin/claude"
  register: claude_check

- name: Install Claude Code
  shell: curl -fsSL https://claude.ai/install.sh | bash
  args:
    creates: "{{ ansible_env.HOME }}/.local/bin/claude"
  when: not claude_check.stat.exists
  environment:
    PATH: "{{ ansible_env.HOME }}/.local/bin:{{ ansible_env.PATH }}"

- name: Check if OpenCode is installed
  stat:
    path: "{{ ansible_env.HOME }}/.local/bin/opencode"
  register: opencode_check

- name: Install OpenCode
  shell: curl -fsSL https://opencode.ai/install | bash
  args:
    creates: "{{ ansible_env.HOME }}/.local/bin/opencode"
  when: not opencode_check.stat.exists
  environment:
    PATH: "{{ ansible_env.HOME }}/.local/bin:{{ ansible_env.PATH }}"

- name: Check if Amp is installed
  stat:
    path: "{{ ansible_env.HOME }}/.local/bin/amp"
  register: amp_check

- name: Install Amp
  shell: curl -fsSL https://ampcode.com/install.sh | bash
  args:
    creates: "{{ ansible_env.HOME }}/.local/bin/amp"
  when: not amp_check.stat.exists
  environment:
    PATH: "{{ ansible_env.HOME }}/.local/bin:{{ ansible_env.PATH }}"
